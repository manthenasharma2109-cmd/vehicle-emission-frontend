<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VEDA - Vehicle Emissions Data Access</title>
  <link rel="icon" type="image/x-icon" href="Logo.png">
  <link rel="shortcut icon" type="image/x-icon" href="logo.png">
  <link rel="apple-touch-icon" href="logo.png">
  <link rel="stylesheet" href="styles.css" />
  <style>
    .brand {
      text-align: center;
      padding: 0;
      margin: 0;
      width: 100%;
      background-color: #ffffff;
      border-bottom: 2px solid #e5e7eb;
      position: relative;
      overflow: hidden;
      min-height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Header background image */
    .header-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('VEDA_updated.png'); /* Replace with your header image path */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 1;
      z-index: 1;
    }

    /* Logo styling */
    .logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 2;
      background: rgba(255, 255, 255, 0.9);
      padding: 15px 30px;
      border-radius: 10px;
      backdrop-filter: blur(5px);
    }

    .logo {
      max-height: 80px;
      max-width: 350px;
      height: auto;
      width: auto;
      object-fit: contain;
      display: block;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }

    /* Admin Panel Specific Fixes */
    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-light);
    }

    .dashboard-header h1 {
      font-family: var(--font-display);
      font-size: 28px;
      font-weight: var(--font-weight-bold);
      color: var(--primary-color);
      margin-bottom: 4px;
    }

    .dashboard-actions {
      display: flex;
      gap: 12px;
    }

    /* Admin Cards Layout */
    .admin-section {
      margin-bottom: 32px;
    }

    .admin-section:last-child {
      margin-bottom: 0;
    }

    /* Filter Section Improvements */
    .admin-filters {
      display: flex;
      flex-wrap: nowrap;
      gap: 12px;
      margin-bottom: 20px;
      align-items: center;
      padding: 16px;
      background: var(--bg-tertiary);
      border-radius: var(--border-radius-md);
      overflow-x: auto;
    }

    .admin-filters input {
      flex: 1;
      min-width: 140px;
      max-width: 200px;
      padding: 10px 14px;
      border: 1px solid var(--border-medium);
      border-radius: var(--border-radius-md);
      font-size: 14px;
    }

    .admin-filters button {
      white-space: nowrap;
      flex-shrink: 0;
    }

    /* Table improvements */
    .admin-table-container {
      background: var(--bg-primary);
      border-radius: var(--border-radius-lg);
      overflow: hidden;
      border: 1px solid var(--border-light);
    }

    .admin-table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border-light);
    }

    .admin-table-title {
      font-size: 18px;
      font-weight: var(--font-weight-semibold);
      color: var(--primary-color);
      margin: 0;
    }

    /* Footer positioning fix */
    .modern-footer {
      margin-top: 40px;
      padding: 32px 0;
      background: var(--bg-primary);
      border-top: 1px solid var(--border-light);
    }

    .disclaimer-section {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px;
      background: #fef9c3;
      border: 1px solid #fde047;
      border-radius: var(--border-radius-lg);
      border-left: 4px solid var(--warning-color);
    }

    .disclaimer-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .disclaimer-icon {
      font-size: 24px;
    }

    .disclaimer-title {
      font-size: 20px;
      font-weight: var(--font-weight-bold);
      color: var(--gray-800);
      margin: 0;
    }

    .disclaimer-text {
      color: var(--gray-700);
      line-height: 1.6;
      font-size: 14px;
    }

    .footer-bottom {
      text-align: center;
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid var(--border-light);
      color: var(--gray-600);
      font-size: 14px;
    }

    /* Responsive fixes */
    @media (max-width: 768px) {
      .brand {
        min-height: 100px;
      }
      
      .logo-container {
        padding: 10px 20px;
      }
      
      .logo {
        max-height: 60px;
        max-width: 280px;
      }

      .dashboard-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
      }

      .dashboard-actions {
        width: 100%;
        justify-content: flex-start;
      }

      .admin-filters {
        flex-wrap: wrap;
        justify-content: flex-start;
      }

      .admin-filters input {
        min-width: 120px;
        max-width: none;
        flex: 1 1 calc(50% - 6px);
      }

      .admin-filters button {
        flex: 1 1 100%;
        margin-top: 8px;
      }
    }

    @media (max-width: 480px) {
      .brand {
        min-height: 80px;
      }
      
      .logo-container {
        padding: 8px 15px;
      }
      
      .logo {
        max-height: 45px;
        max-width: 220px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header>
      <div class="brand">
        <!-- Header background image -->
        <div class="header-bg"></div>
        
        <!-- Logo container -->
        <div class="logo-container">
          <img src="Logo.png" alt="VEDA Logo" class="logo" id="logoImage">
        </div>
      </div>
      <div class="topbar">
        <div id="userGreeting" class="muted">Not signed in</div>
        <button id="logoutBtn" class="btn btn-ghost hidden">Logout</button>
      </div>
    </header>

    <!-- Auth Section -->
    <main>
      <section id="authSection" class="card auth-wrap">
        <div class="auth-tabs">
          <button id="tabLogin" class="btn btn-ghost">Login</button>
          <button id="tabRegister" class="btn btn-ghost">Register</button>
        </div>

        <!-- Login Form -->
        <div id="loginForm">
          <h2>Sign in</h2>
          <p class="muted">Use your email and password. New accounts require admin approval.</p>
          <div class="grid">
            <div>
              <label for="loginEmail">Email</label>
              <input id="loginEmail" type="email" autocomplete="username" />
            </div>
            <div>
              <label for="loginPassword">Password</label>
              <input id="loginPassword" type="password" autocomplete="current-password" />
            </div>
            <div class="form-actions">
              <button id="doLogin" class="btn btn-primary">Login</button>
            </div>
          </div>
        </div>

        <!-- Register Form -->
        <div id="registerForm" class="hidden">
          <h2>Create an account</h2>
          <p class="muted">After registering your account will be pending admin approval.</p>
          <div class="grid">
            <div>
              <label for="regName">Username</label>
              <input id="regName" type="text" autocomplete="name" />
            </div>
            <div>
              <label for="regEmail">Email</label>
              <input id="regEmail" type="email" />
            </div>
            <div>
              <label for="regPassword">Password</label>
              <input id="regPassword" type="password" />
            </div>
            <div>
              <label for="regConfirm">Confirm Password</label>
              <input id="regConfirm" type="password" />
            </div>
            <div class="form-actions">
              <button id="doRegister" class="btn btn-primary">Register</button>
            </div>
          </div>
        </div>
      </section>

      <!-- User Dashboard -->
      <section id="userDashboard" class="hidden">
        <div class="card">
          <div class="dashboard-header">
            <div>
              <h1>User Dashboard</h1>
              <div class="muted">Filter and view EO certificates</div>
            </div>
          </div>
      
          <!-- Filter Dropdowns -->
          <div class="filters">
            <select id="filterYear">
              <option value="">-- Select Year --</option>
            </select>
      
            <select id="filterMake" disabled>
              <option value="">-- Select Make --</option>
            </select>
      
            <select id="filterModel" disabled>
              <option value="">-- Select Model --</option>
            </select>
      
            <select id="filterEoNumber" disabled>
              <option value="">-- Select EO Number --</option>
            </select>
      
            <button id="clearFilters" type="button" class="btn btn-ghost small">Clear</button>
          </div>
      
          <!-- Certificates List -->
          <div class="card">
            <div class="card-header">
              <div class="muted">Results</div>
            </div>
            <div id="certListWrapper">
              <div id="certLoading" class="muted">Loading…</div>
              <div class="table-responsive">
                <table id="certTable" class="hidden">
                  <thead>
                    <tr>
                      <th>EO Number</th>
                      <th>Year</th>
                      <th>Vehicle Make</th>
                      <th>Vehicle Model</th>
                      <th>Manufacturer</th>
                      <th>Engine Size(L)</th>
                      <th>Evap. Family</th>
                      <th>Test Group</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="certBody"></tbody>
                </table>
              </div>
      
              <!-- Pagination -->
              <div id="userPagination" class="pagination hidden">
                <button id="userPrevPage" type="button" class="btn btn-ghost">Previous</button>
                <span id="userPageInfo">Page 1 of 1</span>
                <button id="userNextPage" type="button" class="btn btn-ghost">Next</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Admin Dashboard -->
      <section id="adminDashboard" class="hidden">
        <div class="card">
          <div class="dashboard-header">
            <div>
              <h1>Admin Dashboard</h1>
              <div class="muted">Manage users and EO certificates</div>
            </div>
            <div class="dashboard-actions">
              <button id="refreshUsers" class="btn btn-ghost small">Refresh Users</button>
              <button id="refreshCerts" class="btn btn-ghost small">Refresh Certs</button>
            </div>
          </div>

          <!-- Pending Users Section -->
          <div class="admin-section">
            <div class="admin-table-container">
              <div class="admin-table-header">
                <h2 class="admin-table-title">Pending Users</h2>
              </div>
              <div style="padding: 0 24px 24px 24px;">
                <div id="usersLoading" class="muted">Loading…</div>
                <div class="table-responsive">
                  <table id="usersTable" class="hidden">
                    <thead>
                      <tr>
                        <th>Username</th>
                        <th>Email</th>
                        <th>Status</th>
                        <th>Role</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody id="usersBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- Certificates Section -->
          <div class="admin-section">
            <div class="admin-table-container">
              <div class="admin-table-header">
                <h2 class="admin-table-title">Certificates Management</h2>
                <button id="addCertBtn" class="btn btn-primary small">Add Certificate</button>
              </div>
              
              <div style="padding: 0 24px;">
                <!-- Filter Section -->
                <div class="admin-filters">
                  <input type="text" id="filterEONumber" placeholder="EO Number"
                         oninput="handleFilterChange()" onkeyup="handleFilterKeyup(event)">
                  <input type="text" id="filterYear" placeholder="Year"
                         oninput="handleFilterChange()" onkeyup="handleFilterKeyup(event)">
                  <input type="text" id="filterMake" placeholder="Make"
                         oninput="handleFilterChange()" onkeyup="handleFilterKeyup(event)">
                  <input type="text" id="filterModel" placeholder="Model"
                         oninput="handleFilterChange()" onkeyup="handleFilterKeyup(event)">
                  <button onclick="loadAdminCerts(1)" class="btn btn-primary small">Search</button>
                </div>
              </div>
              
              <div style="padding: 0 24px 24px 24px;">
                <!-- Loader -->
                <div id="certsLoadingAdmin" class="hidden muted">Loading certificates...</div>
              
                <!-- Table -->
                <div class="table-responsive">
                  <table id="adminCertTable" class="hidden">
                    <thead>
                      <tr>
                        <th>EO Number</th>
                        <th>Year</th>
                        <th>Make</th>
                        <th>Model</th>
                        <th>Manufacturer</th>
                        <th>Engine Size</th>
                        <th>Evap. Family</th>
                        <th>Test Group</th>
                        <th>Exhaust ECS</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody id="adminCertBody"></tbody>
                  </table>
                </div>
              
                <!-- Pagination -->
                <div id="pagination" class="pagination hidden">
                  <button id="prevPage" class="btn btn-ghost">Previous</button>
                  <span id="pageInfo">Page 1 of 1</span>
                  <button id="nextPage" class="btn btn-ghost">Next</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    
    <!-- Footer -->
    <footer class="modern-footer">
      <div class="footer-content">
        <div class="disclaimer-section">
          <div class="disclaimer-header">
            <div class="disclaimer-icon">⚠️</div>
            <h2 class="disclaimer-title">Important Disclaimer</h2>
          </div>
          <div class="disclaimer-text">
            This database is compiled from publicly available government data (e.g., CARB). 
            Accuracy is <strong>not guaranteed</strong>, and the information may be incomplete or outdated. 
            Use <strong>at your own discretion</strong>. We are <strong>not affiliated with or endorsed by any government agency</strong>, 
            and VEDA Services <strong>is not liable</strong> for any decisions made based on this data.
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2024 VEDA Services. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </div>

  <!-- Modal -->
  <div id="modal" class="hidden modal-overlay">
    <div class="modal-content card">
      <div class="modal-header">
        <h3 id="modalTitle">Modal</h3>
        <button id="closeModal" class="btn btn-ghost">Close</button>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>

  <!-- Toast container -->
  <div id="toastContainer" class="toast-container"></div>

  <script src="main.js"></script>
</body>
</html>
